language: node_js
sudo: false
cache:
  bundler: true
  directories:
  - node_modules
node_js:
- '0.10'
env:
  global:
  - AWS_ACCESS_KEY_ID=AKIAIT4X4NDGM2WVL6VA
  - DOCKER_USERNAME=octoblu
  - DEPLOY_APPLICATION_NAME=rest-service
  - DEPLOY_REGION=us-west-2
  - DEPLOY_BUCKET=octoblu-deploy
  - DEPLOYMENT_GROUP=master
  - DEPLOY_KEY=rest-service/rest-service-$TRAVIS_COMMIT.zip
  - REST_SERVICE_UUID=ec04aa15-dafe-42cf-b0ea-0cb5731d21d1
  - secure: JT4E22V20PBIuKUcSSgIIaT7EpzevDAI5W1cESjvAXCwTIgmr/wioCjyVRA63TdZ+suAC1Is9hS9sa73UjnAh58STY+sSbmLY+f53qMn7aF0QGe7r7Mr2l+D3jeuOdPSdVLx+35wMal+Bmnr1WYvxQ14QZEoavMmtIUUFYF+Dgblva9nympYipkzbtfy7sz5VeuGF4Gtuw+9eujZGJEX2aOOyxy5Z7+JTFvtnmAFfA4tOTcC117SijhTjZaoC43Q9963aH4AZ29QMnNM9VQJCT3uSEp2l1RZgn2k4kzK3/YFOCEVSsnp0cZhy578M9B2i7RLieMncaia+QhBqzfdxdR2YB+HDbYbr7Cj8Kg+an81qw5B2I5JDKNQLwFjVRRvN9SAz8iFHhtAsdFcPbnKWi++hms8QJDdw/dVPYfyppBdvavdi2UOxoh3d4NsROHxJ1z100DEBkYaEpTa+0llTXJF6HxDOtruS/AYR4lTimc5KlYJQZhPEH04FRB0cPRcTMTukYNuxFdkSH/UYUqR4jezBukZCHCviLVWaSnwOgC+UErOxTpkjMpx5VTtr7mw4R7ZV253WvQ488h7/w4trPgup+ee81Szb/lBf/OK6SC0A9dlXv3Bw54OHNroPVk1CQdrc6bHQ1yrGPKN63M7/gOTy4w6+NOJiNiWQ8xQbMI=
  - secure: mwg90TiYBACBadHgIDJSSBRtOv5Td2oxfwZZ9wQcp0/bS7lZC+t+7SAXH5oMkb9ls6dkFVipQkgu4VlnEndu6d5djfO6ypVyPg8DlK8NWpDMNJsr8UP5FgGUKzTz/COpy3ebHGRQKqVksEaQTtEgIjzd5hEx0/vRKDsZLPEYb+VPPf8w8oGpQ/Hl9n0r1w2U7aIi9gO8JEVBF6q08ivafszbW+dIbHyhZrhTAFXOnkFqzj4MMKqIsDc5IFNUZt/5/PzBM1AYkqDGes/dbjk/48Vp6T5C+wr8GIYfQV07YbifmxMK7S2Zyd2LHf156kdO3v/jny6T67S9ogrY+uuC4zVDJffYVjOc7t3mroXz15JtY+PCh7rwgnERTy+sw9khpNHg+kLaLJmhEddeckdhGdMJhtSlHX16P6GoP9lEnrzt8XgbRBC4Jf9EnfZQVp517/AwA4jR5JEK1R66WVo1sWE+cTszJ5yE6dbWot9q5ohaVh6TmOYBz8mvunuI2JpxExdFFe08XoYCQauHaMX/3pFq5LC8uBMLgXYnPhD/8wq3cDQyCFX6s+gDnq79OC8YpXTwO6udN7bxamcDVMYQera7buvkx6OYW/HvQCBYkazUNvQo5O2bxlEAY/l/aYMspHs1beE0kJVuYl+DfUigztIqKrZwXVCrsS90nVtfm0A=
  - secure: Jf5E6TP1jXBbrCPP/mQVarInAbSrrbN/YQls0qLoiEtx6pPtz6mBpS0Lqw/WxCZd04wNAEpprwvSBgsgoFPZxVK8m9UghKg/9nCjpyiwEUMQou6DUJ9wnQWbjChjJfh3n67JOAK4Jb942aBoE2l9+HIAFqhCHu/Ntg5pSaAtnal2RVJZYWq6B/RFtOuUkUnqAVeJt19TOLNZ0C+clD9tBfNPZhtfsn/z/p8a8jRS6CtbBR1zys5ZZosqAIxkCU+eHyMI32vXMPKKyU3wk2akCgXI97XieOZmScCzC1lctWHbkLBfay7tUQL7JuFsxd1FkTuYx4DKqV7fY9lioAMEC0fKFVTCtHzDNogpf95LtBL5u1GkkBKvKWHm2UMRbQu/FoAGtRXdebGfszdaISQBu5cw/iBkAowk2/GbHOwjIcNp7psoj7wNfWy23ko7ha89wPFcKgSIotx2DcMkHx7zELLPwhirvV691Ccxt6ZJwW6vqW5p5JBIiFJpY/rZE3emA9F653Kth80NaynB85TDXsJ8F72RVnXY+/J7D9lj6uNFkhg3DGukdUH1cYjekj5uWq48PMQHP6gdK570Y5Hf2ST9ywU9pVHApEpICwbe5fLy/rhB0Nyg296JKYDC9vziZ6fESp7+1l/kYSUe6t9rbjr1ko28XS6uLNLs1a4E+Nc=
  - secure: QOC4In6Wcby9zGpu1gRxOC6SxuQMYrviRD7DFpLOotIQrraofqaTfXLJu5qPCD8NeA24LtWb/ZkHddj8zTT3NOE1X5eADfdpdzF6uSHwZxnXvlGLFU6OeUZ4UHRK+hZOTY2pJ/HQDW4THOBTo+HbQHZKLvajSDn/E68rSasDABqLyQggbeivKgeCTMESaU9KwT0Z+HZqYdw7u4ND2SjGfYCJ9nWO1UInlUAfFky0lA15yjEzEw+FSUy5rK2Soeb/bTU08DomRqbJh/f0cNiyYqYaRhxc0CXbZgSv4Vg3REnVZc8+w5LVVGi/Ncpxx1DBycqOJlh9/i5GCDicZ95ePS59zD+q+Gux/oQstRa5NLsfu6Hc4+ozEwLSw6uTK67V+vtEPoDcdfwkZ3AjTrEhNZACymVODOF4jXZ4z6RvqUnY4ojjYmBxNDoIujyHe5pGiz+Tl1L7nCjmVCjOrFum1e2XIPuGpDumE/yUkdbIWVXS503MS2PhQN8rQuK0bs3EH+zBJCdHJ1zeGu9T/lDqkS7N3DOYNxIntOK8mbl1QmorYinDnWl+8X4HPp/C01y06qO41yBpBHoWzwaxzAJb5llS6YC+hA70mSBF7ErEPezyNmosmm2nwnjrMj+dff7gg/OmIkiprz7308oE9IfIfU3IbGQ+hx68O5Cug/123ds=
after_success:
- .kubernetes/travis_after_success
deploy:
- provider: s3
  access_key_id: AKIAIT4X4NDGM2WVL6VA
  secret_access_key: &1
    secure: jv6TzUDFJq82Jt0FUwQd4veJam8dA05WNT+PnJVW9OEJwny3Sc+tERFQIi5gn8hqDHkGsIwuPtcWCK2daO7IE1Zu3evodKw7OAb8mQtLLPv28n1wlc89pDZUQrwtY455EnVFWEvympS445Gz3OPGzRsWPuhtlc93J8mfF8Vqe6Zry+kcUfom879am706nYpm8Tbi8xQ8mAQhADcNZ0J/TSniNdZlXpKEl8xihfyoRZAHd5KNA6CpdPbV1fCzucLUoQlgieT89qDhbzfcrsHacTHVR1ajdVFB0Cwo+ED4puk/Hah0UqjF5sIgYUW1NoppsUL6nD5w4I9KgpY6Be2Y48o4W7K+/DIYORBVRvhJKVHgZBrVsOu/PRB9/vP4wOXK8D9PRqjRdQ+0QI3PKqGHvepSw3ph+J4q4GlmSzELnzvxkD10DgoRuSnqvXpStiVduoXHWU4w4IMbM/xKi8RgLQfNoHpzbmXyPtWXtu4IFykIkJSaZHp1n7HWlEU5/4cDX3g6a21Lty146dQ4L4LncoP7jW6xVC/4jxBKtat7y71MCfqbB/zmRVKMKnMNr91UkxbnGhdQCppeU2fk70y1s4sEPdmcAfl7ab63BqOletP+EKvQs0BWox6OpibD0hrcyDOrHSxx8s2b3oI1+lOAtN8ZPBlVnHuiHJOl4btcenU=
  local_dir: dpl_cd_upload
  skip_cleanup: true
  bucket: octoblu-deploy
  on:
    branch: master
- provider: codedeploy
  access_key_id: AKIAIT4X4NDGM2WVL6VA
  secret_access_key: *1
  bucket: octoblu-deploy
  key: docker-builder/rest-service-$TRAVIS_COMMIT.zip
  bundle_type: zip
  region: us-west-2
  application: docker-builder
  deployment_group: rest-service
  on:
    branch: master
